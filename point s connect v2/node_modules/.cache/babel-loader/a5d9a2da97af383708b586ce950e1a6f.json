{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\ZDLaP\\\\Desktop\\\\ReactProject\\\\connect\\\\point s connect v2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"C:\\\\Users\\\\ZDLaP\\\\Desktop\\\\ReactProject\\\\connect\\\\point s connect v2\\\\src\\\\views\\\\addAccount.jsx\";\nimport React, { Component } from 'react';\nimport { signup, checkUsernameAvailability, checkEmailAvailability } from '../util/APIUtils';\nimport '../assets/css/Signup.css';\nimport { Link } from 'react-router-dom';\nimport { NAME_MIN_LENGTH, NAME_MAX_LENGTH, USERNAME_MIN_LENGTH, USERNAME_MAX_LENGTH, EMAIL_MAX_LENGTH, PASSWORD_MIN_LENGTH, PASSWORD_MAX_LENGTH } from '../constants';\nimport { Form, Input, Button, notification, Select } from 'antd';\nconst FormItem = Form.Item;\nconst Option = Select.Option;\n\nclass addAccount extends Component {\n  constructor(props) {\n    super(props);\n\n    this.validateFranchise = value => {\n      if (!value) {\n        return {\n          validateStatus: false,\n          errorMsg: 'Content may not be empty'\n        };\n      }\n\n      if (value.trim() == \"\") {\n        return {\n          validateStatus: false,\n          errorMsg: 'Content may not be empty'\n        };\n      }\n\n      return {\n        validateStatus: true,\n        errorMsg: null\n      };\n    };\n\n    this.validateName = name => {\n      if (name.length < NAME_MIN_LENGTH) {\n        return {\n          validateStatus: false,\n          errorMsg: \"Name is too short (Minimum \".concat(NAME_MIN_LENGTH, \" characters needed.)\")\n        };\n      } else if (name.length > NAME_MAX_LENGTH) {\n        return {\n          validationStatus: false,\n          errorMsg: \"Name is too long (Maximum \".concat(NAME_MAX_LENGTH, \" characters allowed.)\")\n        };\n      } else {\n        return {\n          validateStatus: true,\n          errorMsg: null\n        };\n      }\n    };\n\n    this.validateEmail = email => {\n      if (!email) {\n        return {\n          validateStatus: false,\n          errorMsg: 'Email may not be empty'\n        };\n      }\n\n      const EMAIL_REGEX = RegExp('[^@ ]+@[^@ ]+\\\\.[^@ ]+');\n\n      if (!EMAIL_REGEX.test(email)) {\n        return {\n          validateStatus: false,\n          errorMsg: 'Email not valid'\n        };\n      }\n\n      if (email.length > EMAIL_MAX_LENGTH) {\n        return {\n          validateStatus: false,\n          errorMsg: \"Email is too long (Maximum \".concat(EMAIL_MAX_LENGTH, \" characters allowed)\")\n        };\n      }\n\n      return {\n        validateStatus: null,\n        errorMsg: null\n      };\n    };\n\n    this.validateUsername = username => {\n      if (username.length < USERNAME_MIN_LENGTH) {\n        return {\n          validateStatus: false,\n          errorMsg: \"Username is too short (Minimum \".concat(USERNAME_MIN_LENGTH, \" characters needed.)\")\n        };\n      } else if (username.length > USERNAME_MAX_LENGTH) {\n        return {\n          validationStatus: false,\n          errorMsg: \"Username is too long (Maximum \".concat(USERNAME_MAX_LENGTH, \" characters allowed.)\")\n        };\n      } else {\n        return {\n          validateStatus: null,\n          errorMsg: null\n        };\n      }\n    };\n\n    this.validatePassword = password => {\n      if (password.length < PASSWORD_MIN_LENGTH) {\n        return {\n          validateStatus: false,\n          errorMsg: \"Password is too short (Minimum \".concat(PASSWORD_MIN_LENGTH, \" characters needed.)\")\n        };\n      } else if (password.length > PASSWORD_MAX_LENGTH) {\n        return {\n          validationStatus: false,\n          errorMsg: \"Password is too long (Maximum \".concat(PASSWORD_MAX_LENGTH, \" characters allowed.)\")\n        };\n      } else {\n        return {\n          validateStatus: true,\n          errorMsg: null\n        };\n      }\n    };\n\n    this.state = {\n      name: {\n        value: ''\n      },\n      username: {\n        value: ''\n      },\n      email: {\n        value: ''\n      },\n      password: {\n        value: ''\n      },\n      role: {\n        value: ''\n      },\n      ville: {\n        value: ''\n      },\n      societe: {\n        value: ''\n      },\n      fonction: {\n        value: ''\n      },\n      roles: []\n    };\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.validateUsernameAvailability = this.validateUsernameAvailability.bind(this);\n    this.validateEmailAvailability = this.validateEmailAvailability.bind(this);\n    this.isFormInvalid = this.isFormInvalid.bind(this);\n    this.onChangeSelect = this.onChangeSelect.bind(this);\n    this.validateFranchise = this.validateFranchise.bind(this);\n    this.handleRole = this.handleRole.bind(this);\n    this.renderElementSupplementaire = this.renderElementSupplementaire.bind(this);\n  }\n\n  componentDidMount() {\n    fetch(API_BASE_URL + \"/roles\").then(res => res.json()).then(result => {\n      this.setState({\n        roles: result\n      });\n    }, error => {\n      this.setState({\n        error\n      });\n    });\n  }\n\n  renderElementSupplementaire(role) {\n    if (role === 'Franch') {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(FormItem, {\n        label: \"Ville\",\n        validateStatus: this.state.ville.validateStatus,\n        help: this.state.ville.errorMsg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(Input, {\n        size: \"large\",\n        name: \"ville\",\n        autoComplete: \"off\",\n        placeholder: \"ex: Casablanca\",\n        value: this.state.ville.value,\n        onChange: event => this.handleRole(event, this.validateFranchise),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })), React.createElement(FormItem, {\n        label: \"Fonction\",\n        validateStatus: this.state.fonction.validateStatus,\n        help: this.state.fonction.errorMsg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(Input, {\n        size: \"large\",\n        name: \"fonctionFr\",\n        autoComplete: \"off\",\n        placeholder: \"ex: responsable marketing\",\n        value: this.state.fonction.value,\n        onChange: event => this.handleRole(event, this.validateFranchise),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      })));\n    }\n\n    if (role === 'GCompte') {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(FormItem, {\n        label: \"Societe\",\n        validateStatus: this.state.societe.validateStatus,\n        help: this.state.societe.errorMsg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(Input, {\n        size: \"large\",\n        name: \"societe\",\n        autoComplete: \"off\",\n        placeholder: \"ex: IAM\",\n        value: this.state.societe.value,\n        onChange: event => this.handleRole(event, this.validateFranchise),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      })), React.createElement(FormItem, {\n        label: \"Fonction\",\n        validateStatus: this.state.fonction.validateStatus,\n        help: this.state.fonction.errorMsg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(Input, {\n        size: \"large\",\n        name: \"fonctionGc\",\n        autoComplete: \"off\",\n        placeholder: \"ex: responsable marketing\",\n        value: this.state.fonction.value,\n        onChange: event => this.handleRole(event, this.validateFranchise),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      })));\n    }\n  }\n\n  handleRole(event, validationFun) {\n    const target = event.target;\n    const inputName = target.name;\n    const inputValue = target.value;\n\n    if (inputName === \"fonctionGc\") {\n      this.setState({\n        'fonction': _objectSpread({\n          'value': inputValue\n        }, validationFun(inputValue))\n      });\n    }\n\n    if (inputName === \"fonctionFr\") {\n      this.setState({\n        'fonction': _objectSpread({\n          'value': inputValue\n        }, validationFun(inputValue))\n      });\n    }\n\n    if (inputName === \"ville\") {\n      this.setState({\n        'ville': _objectSpread({\n          'value': inputValue\n        }, validationFun(inputValue))\n      });\n    }\n\n    if (inputName === \"societe\") {\n      this.setState({\n        'societe': _objectSpread({\n          'value': inputValue\n        }, validationFun(inputValue))\n      });\n    }\n  }\n\n  handleInputChange(event, validationFun) {\n    const target = event.target;\n    const inputName = target.name;\n    const inputValue = target.value;\n    this.setState({\n      [inputName]: _objectSpread({\n        value: inputValue\n      }, validationFun(inputValue))\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    const createAccountRequest = {\n      name: this.state.name.value,\n      email: this.state.email.value,\n      username: this.state.username.value,\n      password: this.state.password.value,\n      role: this.state.role.value\n    };\n    /*signup(signupRequest)\r\n    .then(response => {\r\n        notification.success({\r\n            message: 'Polling App',\r\n            description: \"Thank you! Account has been created successfully !\",\r\n        });          \r\n        this.props.history.push(\"/login\");\r\n    }).catch(error => {\r\n        notification.error({\r\n            message: 'Polling App',\r\n            description: error.message || 'Sorry! Something went wrong. Please try again!'\r\n        });\r\n    });*/\n  }\n\n  isFormInvalid() {\n    if (this.state.role.value === 'PSD') {\n      return !(this.state.name.validateStatus === true && this.state.username.validateStatus === true && this.state.email.validateStatus === true && this.state.password.validateStatus === true && this.state.role.validateStatus === true);\n    }\n\n    if (this.state.role.value === 'Franch') {\n      return !(this.state.name.validateStatus === true && this.state.username.validateStatus === true && this.state.email.validateStatus === true && this.state.password.validateStatus === true && this.state.role.validateStatus === true && this.state.fonction.validateStatus === true && this.state.ville.validateStatus === true);\n    }\n\n    if (this.state.role.value === 'GCompte') {\n      return !(this.state.name.validateStatus === true && this.state.username.validateStatus === true && this.state.email.validateStatus === true && this.state.password.validateStatus === true && this.state.role.validateStatus === true && this.state.fonction.validateStatus === true && this.state.societe.validateStatus === true);\n    }\n\n    return true;\n  }\n\n  onChangeSelect(value) {\n    this.setState({\n      'role': {\n        'value': value,\n        'validateStatus': true,\n        'errorMsg': null\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"signup-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"page-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, \"Creation d'un compte :\"), React.createElement(\"div\", {\n      className: \"signup-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(Form, {\n      onSubmit: this.handleSubmit,\n      className: \"signup-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(FormItem, {\n      label: \"Full Name\",\n      validateStatus: this.state.name.validateStatus,\n      help: this.state.name.errorMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(Input, {\n      size: \"large\",\n      name: \"name\",\n      autoComplete: \"off\",\n      placeholder: \"Full name\",\n      value: this.state.name.value,\n      onChange: event => this.handleInputChange(event, this.validateName),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    })), React.createElement(FormItem, {\n      label: \"Username\",\n      hasFeedback: true,\n      validateStatus: this.state.username.validateStatus,\n      help: this.state.username.errorMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(Input, {\n      size: \"large\",\n      name: \"username\",\n      autoComplete: \"off\",\n      placeholder: \"A unique username\",\n      value: this.state.username.value,\n      onBlur: this.validateUsernameAvailability,\n      onChange: event => this.handleInputChange(event, this.validateUsername),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    })), React.createElement(FormItem, {\n      label: \"Email\",\n      hasFeedback: true,\n      validateStatus: this.state.email.validateStatus,\n      help: this.state.email.errorMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314\n      },\n      __self: this\n    }, React.createElement(Input, {\n      size: \"large\",\n      name: \"email\",\n      type: \"email\",\n      autoComplete: \"off\",\n      placeholder: \"Your email\",\n      value: this.state.email.value,\n      onBlur: this.validateEmailAvailability,\n      onChange: event => this.handleInputChange(event, this.validateEmail),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    })), React.createElement(FormItem, {\n      label: \"Password\",\n      validateStatus: this.state.password.validateStatus,\n      help: this.state.password.errorMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    }, React.createElement(Input, {\n      size: \"large\",\n      name: \"password\",\n      type: \"password\",\n      autoComplete: \"off\",\n      placeholder: \"A password between 6 to 20 characters\",\n      value: this.state.password.value,\n      onChange: event => this.handleInputChange(event, this.validatePassword),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    })), React.createElement(FormItem, {\n      label: \"Role\",\n      validateStatus: this.state.role.validateStatus,\n      help: this.state.role.errorMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, React.createElement(Select, {\n      showSearch: true,\n      style: {\n        width: 200\n      },\n      placeholder: \"Select a role\",\n      optionFilterProp: \"children\",\n      onChange: this.onChangeSelect,\n      filterOption: (input, option) => option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    }, this.state.roles.map(function (role) {\n      return React.createElement(Option, {\n        value: role.name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, role.name);\n    }))), this.renderElementSupplementaire(this.state.role.value), React.createElement(FormItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      size: \"large\",\n      className: \"signup-form-button\",\n      disabled: this.isFormInvalid(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368\n      },\n      __self: this\n    }, \"Creation de compte\")))));\n  } // Validation Functions\n\n\n  validateUsernameAvailability() {\n    // First check for client side errors in username\n    const usernameValue = this.state.username.value;\n    const usernameValidation = this.validateUsername(usernameValue);\n\n    if (usernameValidation.validateStatus === false) {\n      this.setState({\n        username: _objectSpread({\n          value: usernameValue\n        }, usernameValidation)\n      });\n      return;\n    }\n\n    this.setState({\n      username: {\n        value: usernameValue,\n        validateStatus: 'validating',\n        errorMsg: null\n      }\n    });\n    checkUsernameAvailability(usernameValue).then(response => {\n      if (response.available) {\n        this.setState({\n          username: {\n            value: usernameValue,\n            validateStatus: true,\n            errorMsg: null\n          }\n        });\n      } else {\n        this.setState({\n          username: {\n            value: usernameValue,\n            validateStatus: false,\n            errorMsg: 'This username is already taken'\n          }\n        });\n      }\n    }).catch(error => {\n      // Marking validateStatus as success, Form will be recchecked at server\n      this.setState({\n        username: {\n          value: usernameValue,\n          validateStatus: true,\n          errorMsg: null\n        }\n      });\n    });\n  }\n\n  validateEmailAvailability() {\n    // First check for client side errors in email\n    const emailValue = this.state.email.value;\n    const emailValidation = this.validateEmail(emailValue);\n\n    if (emailValidation.validateStatus === false) {\n      this.setState({\n        email: _objectSpread({\n          value: emailValue\n        }, emailValidation)\n      });\n      return;\n    }\n\n    this.setState({\n      email: {\n        value: emailValue,\n        validateStatus: 'validating',\n        errorMsg: null\n      }\n    });\n    checkEmailAvailability(emailValue).then(response => {\n      if (response.available) {\n        this.setState({\n          email: {\n            value: emailValue,\n            validateStatus: true,\n            errorMsg: null\n          }\n        });\n      } else {\n        this.setState({\n          email: {\n            value: emailValue,\n            validateStatus: false,\n            errorMsg: 'This Email is already registered'\n          }\n        });\n      }\n    }).catch(error => {\n      // Marking validateStatus as success, Form will be recchecked at server\n      this.setState({\n        email: {\n          value: emailValue,\n          validateStatus: true,\n          errorMsg: null\n        }\n      });\n    });\n  }\n\n}\n\nexport default addAccount;","map":{"version":3,"sources":["C:\\Users\\ZDLaP\\Desktop\\ReactProject\\connect\\point s connect v2\\src\\views\\addAccount.jsx"],"names":["React","Component","signup","checkUsernameAvailability","checkEmailAvailability","Link","NAME_MIN_LENGTH","NAME_MAX_LENGTH","USERNAME_MIN_LENGTH","USERNAME_MAX_LENGTH","EMAIL_MAX_LENGTH","PASSWORD_MIN_LENGTH","PASSWORD_MAX_LENGTH","Form","Input","Button","notification","Select","FormItem","Item","Option","addAccount","constructor","props","validateFranchise","value","validateStatus","errorMsg","trim","validateName","name","length","validationStatus","validateEmail","email","EMAIL_REGEX","RegExp","test","validateUsername","username","validatePassword","password","state","role","ville","societe","fonction","roles","handleInputChange","bind","handleSubmit","validateUsernameAvailability","validateEmailAvailability","isFormInvalid","onChangeSelect","handleRole","renderElementSupplementaire","componentDidMount","fetch","API_BASE_URL","then","res","json","result","setState","error","event","validationFun","target","inputName","inputValue","preventDefault","createAccountRequest","render","width","input","option","children","toLowerCase","indexOf","map","usernameValue","usernameValidation","response","available","catch","emailValue","emailValidation"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,MAAT,EAAiBC,yBAAjB,EAA4CC,sBAA5C,QAA0E,kBAA1E;AACA,OAAO,0BAAP;AACA,SAASC,IAAT,QAAqB,kBAArB;AAEA,SACIC,eADJ,EACqBC,eADrB,EAEIC,mBAFJ,EAEyBC,mBAFzB,EAGIC,gBAHJ,EAIIC,mBAJJ,EAIyBC,mBAJzB,QAKO,cALP;AAOA,SAASC,IAAT,EAAeC,KAAf,EAAsBC,MAAtB,EAA8BC,YAA9B,EAA2CC,MAA3C,QAAyD,MAAzD;AACA,MAAMC,QAAQ,GAAGL,IAAI,CAACM,IAAtB;MACQC,M,GAAWH,M,CAAXG,M;;AAER,MAAMC,UAAN,SAAyBpB,SAAzB,CAAmC;AAC/BqB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA4WnBC,iBA5WmB,GA4WAC,KAAD,IAAS;AACvB,UAAG,CAACA,KAAJ,EAAW;AACP,eAAO;AACHC,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAKH;;AACD,UAAGF,KAAK,CAACG,IAAN,MAAc,EAAjB,EACA;AACI,eAAO;AACHF,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAKH;;AAED,aAAO;AACCD,QAAAA,cAAc,EAAE,IADjB;AAECC,QAAAA,QAAQ,EAAE;AAFX,OAAP;AAIH,KAjYkB;;AAAA,SAoYnBE,YApYmB,GAoYHC,IAAD,IAAU;AACrB,UAAGA,IAAI,CAACC,MAAL,GAAczB,eAAjB,EAAkC;AAC9B,eAAO;AACHoB,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,uCAAgCrB,eAAhC;AAFL,SAAP;AAIH,OALD,MAKO,IAAIwB,IAAI,CAACC,MAAL,GAAcxB,eAAlB,EAAmC;AACtC,eAAO;AACHyB,UAAAA,gBAAgB,EAAE,KADf;AAEHL,UAAAA,QAAQ,sCAA+BpB,eAA/B;AAFL,SAAP;AAIH,OALM,MAKA;AACH,eAAO;AACHmB,UAAAA,cAAc,EAAE,IADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAIH;AACJ,KArZkB;;AAAA,SAuZnBM,aAvZmB,GAuZFC,KAAD,IAAW;AACvB,UAAG,CAACA,KAAJ,EAAW;AACP,eAAO;AACHR,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAIH;;AAED,YAAMQ,WAAW,GAAGC,MAAM,CAAC,wBAAD,CAA1B;;AACA,UAAG,CAACD,WAAW,CAACE,IAAZ,CAAiBH,KAAjB,CAAJ,EAA6B;AACzB,eAAO;AACHR,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAIH;;AAED,UAAGO,KAAK,CAACH,MAAN,GAAerB,gBAAlB,EAAoC;AAChC,eAAO;AACHgB,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,uCAAgCjB,gBAAhC;AAFL,SAAP;AAIH;;AAED,aAAO;AACHgB,QAAAA,cAAc,EAAE,IADb;AAEHC,QAAAA,QAAQ,EAAE;AAFP,OAAP;AAIH,KAlbkB;;AAAA,SAobnBW,gBApbmB,GAobCC,QAAD,IAAc;AAC7B,UAAGA,QAAQ,CAACR,MAAT,GAAkBvB,mBAArB,EAA0C;AACtC,eAAO;AACHkB,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,2CAAoCnB,mBAApC;AAFL,SAAP;AAIH,OALD,MAKO,IAAI+B,QAAQ,CAACR,MAAT,GAAkBtB,mBAAtB,EAA2C;AAC9C,eAAO;AACHuB,UAAAA,gBAAgB,EAAE,KADf;AAEHL,UAAAA,QAAQ,0CAAmClB,mBAAnC;AAFL,SAAP;AAIH,OALM,MAKA;AACH,eAAO;AACHiB,UAAAA,cAAc,EAAE,IADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAIH;AACJ,KArckB;;AAAA,SAmjBnBa,gBAnjBmB,GAmjBCC,QAAD,IAAc;AAC7B,UAAGA,QAAQ,CAACV,MAAT,GAAkBpB,mBAArB,EAA0C;AACtC,eAAO;AACHe,UAAAA,cAAc,EAAE,KADb;AAEHC,UAAAA,QAAQ,2CAAoChB,mBAApC;AAFL,SAAP;AAIH,OALD,MAKO,IAAI8B,QAAQ,CAACV,MAAT,GAAkBnB,mBAAtB,EAA2C;AAC9C,eAAO;AACHoB,UAAAA,gBAAgB,EAAE,KADf;AAEHL,UAAAA,QAAQ,0CAAmCf,mBAAnC;AAFL,SAAP;AAIH,OALM,MAKA;AACH,eAAO;AACHc,UAAAA,cAAc,EAAE,IADb;AAEHC,UAAAA,QAAQ,EAAE;AAFP,SAAP;AAIH;AACJ,KApkBkB;;AAEf,SAAKe,KAAL,GAAa;AACTZ,MAAAA,IAAI,EAAE;AACFL,QAAAA,KAAK,EAAE;AADL,OADG;AAITc,MAAAA,QAAQ,EAAE;AACNd,QAAAA,KAAK,EAAE;AADD,OAJD;AAOTS,MAAAA,KAAK,EAAE;AACHT,QAAAA,KAAK,EAAE;AADJ,OAPE;AAUTgB,MAAAA,QAAQ,EAAE;AACNhB,QAAAA,KAAK,EAAE;AADD,OAVD;AAaTkB,MAAAA,IAAI,EAAC;AACDlB,QAAAA,KAAK,EAAC;AADL,OAbI;AAgBTmB,MAAAA,KAAK,EAAC;AACEnB,QAAAA,KAAK,EAAC;AADR,OAhBG;AAmBToB,MAAAA,OAAO,EACH;AACKpB,QAAAA,KAAK,EAAC;AADX,OApBK;AAuBTqB,MAAAA,QAAQ,EACC;AACIrB,QAAAA,KAAK,EAAC;AADV,OAxBA;AA2BTsB,MAAAA,KAAK,EAAC;AA3BG,KAAb;AAgCA,SAAKC,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKE,4BAAL,GAAoC,KAAKA,4BAAL,CAAkCF,IAAlC,CAAuC,IAAvC,CAApC;AACA,SAAKG,yBAAL,GAAiC,KAAKA,yBAAL,CAA+BH,IAA/B,CAAoC,IAApC,CAAjC;AACA,SAAKI,aAAL,GAAqB,KAAKA,aAAL,CAAmBJ,IAAnB,CAAwB,IAAxB,CAArB;AACA,SAAKK,cAAL,GAAsB,KAAKA,cAAL,CAAoBL,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKzB,iBAAL,GAAuB,KAAKA,iBAAL,CAAuByB,IAAvB,CAA4B,IAA5B,CAAvB;AACA,SAAKM,UAAL,GAAgB,KAAKA,UAAL,CAAgBN,IAAhB,CAAqB,IAArB,CAAhB;AACA,SAAKO,2BAAL,GAAiC,KAAKA,2BAAL,CAAiCP,IAAjC,CAAsC,IAAtC,CAAjC;AACH;;AACDQ,EAAAA,iBAAiB,GAAG;AAChBC,IAAAA,KAAK,CAACC,YAAY,GAAG,QAAhB,CAAL,CACGC,IADH,CACQC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADf,EAEGF,IAFH,CAGKG,MAAD,IAAY;AACV,WAAKC,QAAL,CAAc;AACZjB,QAAAA,KAAK,EAAEgB;AADK,OAAd;AAGD,KAPL,EASKE,KAAD,IAAW;AACT,WAAKD,QAAL,CAAc;AACZC,QAAAA;AADY,OAAd;AAGD,KAbL;AAeD;;AACNT,EAAAA,2BAA2B,CAACb,IAAD,EACxB;AACI,QAAGA,IAAI,KAAG,QAAV,EACA;AACI,aACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,QAAD;AAAU,QAAA,KAAK,EAAC,OAAhB;AACY,QAAA,cAAc,EAAE,KAAKD,KAAL,CAAWE,KAAX,CAAiBlB,cAD7C;AAEY,QAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWE,KAAX,CAAiBjB,QAFnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIY,oBAAC,KAAD;AACQ,QAAA,IAAI,EAAC,OADb;AAEQ,QAAA,IAAI,EAAC,OAFb;AAGQ,QAAA,YAAY,EAAC,KAHrB;AAIQ,QAAA,WAAW,EAAC,gBAJpB;AAKQ,QAAA,KAAK,EAAG,KAAKe,KAAL,CAAWE,KAAX,CAAiBnB,KALjC;AAMQ,QAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKX,UAAL,CAAgBW,KAAhB,EAAuB,KAAK1C,iBAA5B,CAN7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJZ,CADJ,EAaI,oBAAC,QAAD;AACA,QAAA,KAAK,EAAC,UADN;AAEA,QAAA,cAAc,EAAE,KAAKkB,KAAL,CAAWI,QAAX,CAAoBpB,cAFpC;AAGA,QAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWI,QAAX,CAAoBnB,QAH1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKA,oBAAC,KAAD;AACI,QAAA,IAAI,EAAC,OADT;AAEI,QAAA,IAAI,EAAC,YAFT;AAGI,QAAA,YAAY,EAAC,KAHjB;AAII,QAAA,WAAW,EAAC,2BAJhB;AAKI,QAAA,KAAK,EAAE,KAAKe,KAAL,CAAWI,QAAX,CAAoBrB,KAL/B;AAMI,QAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKX,UAAL,CAAgBW,KAAhB,EAAuB,KAAK1C,iBAA5B,CANzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALA,CAbJ,CADA;AA8BH;;AACD,QAAGmB,IAAI,KAAI,SAAX,EACA;AACI,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,oBAAC,QAAD;AAAU,QAAA,KAAK,EAAC,SAAhB;AACY,QAAA,cAAc,EAAE,KAAKD,KAAL,CAAWG,OAAX,CAAmBnB,cAD/C;AAEY,QAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWG,OAAX,CAAmBlB,QAFrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIgB,oBAAC,KAAD;AACI,QAAA,IAAI,EAAC,OADT;AAEI,QAAA,IAAI,EAAC,SAFT;AAGI,QAAA,YAAY,EAAC,KAHjB;AAII,QAAA,WAAW,EAAC,SAJhB;AAKI,QAAA,KAAK,EAAE,KAAKe,KAAL,CAAWG,OAAX,CAAmBpB,KAL9B;AAMI,QAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKX,UAAL,CAAgBW,KAAhB,EAAuB,KAAK1C,iBAA5B,CANzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJhB,CADA,EAaA,oBAAC,QAAD;AAAU,QAAA,KAAK,EAAC,UAAhB;AACY,QAAA,cAAc,EAAE,KAAKkB,KAAL,CAAWI,QAAX,CAAoBpB,cADhD;AAEY,QAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWI,QAAX,CAAoBnB,QAFtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIA,oBAAC,KAAD;AACI,QAAA,IAAI,EAAC,OADT;AAEI,QAAA,IAAI,EAAC,YAFT;AAGI,QAAA,YAAY,EAAC,KAHjB;AAII,QAAA,WAAW,EAAC,2BAJhB;AAKI,QAAA,KAAK,EAAE,KAAKe,KAAL,CAAWI,QAAX,CAAoBrB,KAL/B;AAMI,QAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKX,UAAL,CAAgBW,KAAhB,EAAuB,KAAK1C,iBAA5B,CANzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJA,CAbA,CADJ;AA4BC;AAGR;;AACD+B,EAAAA,UAAU,CAACW,KAAD,EAAOC,aAAP,EAAqB;AAC3B,UAAMC,MAAM,GAAGF,KAAK,CAACE,MAArB;AACA,UAAMC,SAAS,GAAGD,MAAM,CAACtC,IAAzB;AACA,UAAMwC,UAAU,GAAGF,MAAM,CAAC3C,KAA1B;;AACA,QAAG4C,SAAS,KAAG,YAAf,EACA;AACI,WAAKL,QAAL,CAAc;AACN;AACI,mBAASM;AADb,WAEOH,aAAa,CAACG,UAAD,CAFpB;AADM,OAAd;AAOH;;AACD,QAAGD,SAAS,KAAG,YAAf,EACA;AACI,WAAKL,QAAL,CAAc;AAEN;AACI,mBAAQM;AADZ,WAEWH,aAAa,CAACG,UAAD,CAFxB;AAFM,OAAd;AAOH;;AACD,QAAGD,SAAS,KAAG,OAAf,EACA;AACI,WAAKL,QAAL,CAAc;AAEN;AACI,mBAAQM;AADZ,WAEOH,aAAa,CAACG,UAAD,CAFpB;AAFM,OAAd;AAQH;;AACD,QAAGD,SAAS,KAAG,SAAf,EACA;AACI,WAAKL,QAAL,CAAc;AAGN;AACI,mBAASM;AADb,WAEOH,aAAa,CAACG,UAAD,CAFpB;AAHM,OAAd;AASH;AACJ;;AACDtB,EAAAA,iBAAiB,CAACkB,KAAD,EAAQC,aAAR,EAAuB;AACpC,UAAMC,MAAM,GAAGF,KAAK,CAACE,MAArB;AACA,UAAMC,SAAS,GAAGD,MAAM,CAACtC,IAAzB;AACA,UAAMwC,UAAU,GAAGF,MAAM,CAAC3C,KAA1B;AAEA,SAAKuC,QAAL,CAAc;AACV,OAACK,SAAD;AACI5C,QAAAA,KAAK,EAAE6C;AADX,SAEOH,aAAa,CAACG,UAAD,CAFpB;AADU,KAAd;AAMP;;AAEGpB,EAAAA,YAAY,CAACgB,KAAD,EAAQ;AAChBA,IAAAA,KAAK,CAACK,cAAN;AAEA,UAAMC,oBAAoB,GAAG;AACzB1C,MAAAA,IAAI,EAAE,KAAKY,KAAL,CAAWZ,IAAX,CAAgBL,KADG;AAEzBS,MAAAA,KAAK,EAAE,KAAKQ,KAAL,CAAWR,KAAX,CAAiBT,KAFC;AAGzBc,MAAAA,QAAQ,EAAE,KAAKG,KAAL,CAAWH,QAAX,CAAoBd,KAHL;AAIzBgB,MAAAA,QAAQ,EAAE,KAAKC,KAAL,CAAWD,QAAX,CAAoBhB,KAJL;AAKzBkB,MAAAA,IAAI,EAAG,KAAKD,KAAL,CAAWC,IAAX,CAAgBlB;AALE,KAA7B;AAOA;;;;;;;;;;;;;AAaH;;AAED4B,EAAAA,aAAa,GAAG;AAEZ,QAAG,KAAKX,KAAL,CAAWC,IAAX,CAAgBlB,KAAhB,KAAwB,KAA3B,EACA;AACA,aAAO,EAAE,KAAKiB,KAAL,CAAWZ,IAAX,CAAgBJ,cAAhB,KAAmC,IAAnC,IACL,KAAKgB,KAAL,CAAWH,QAAX,CAAoBb,cAApB,KAAuC,IADlC,IAEL,KAAKgB,KAAL,CAAWR,KAAX,CAAiBR,cAAjB,KAAoC,IAF/B,IAGL,KAAKgB,KAAL,CAAWD,QAAX,CAAoBf,cAApB,KAAuC,IAHlC,IAIL,KAAKgB,KAAL,CAAWC,IAAX,CAAgBjB,cAAhB,KAAmC,IAJhC,CAAP;AAMC;;AACD,QAAG,KAAKgB,KAAL,CAAWC,IAAX,CAAgBlB,KAAhB,KAAwB,QAA3B,EACA;AACI,aAAO,EAAE,KAAKiB,KAAL,CAAWZ,IAAX,CAAgBJ,cAAhB,KAAmC,IAAnC,IACT,KAAKgB,KAAL,CAAWH,QAAX,CAAoBb,cAApB,KAAuC,IAD9B,IAET,KAAKgB,KAAL,CAAWR,KAAX,CAAiBR,cAAjB,KAAoC,IAF3B,IAGT,KAAKgB,KAAL,CAAWD,QAAX,CAAoBf,cAApB,KAAuC,IAH9B,IAIT,KAAKgB,KAAL,CAAWC,IAAX,CAAgBjB,cAAhB,KAAmC,IAJ1B,IAKT,KAAKgB,KAAL,CAAWI,QAAX,CAAoBpB,cAApB,KAAuC,IAL9B,IAMT,KAAKgB,KAAL,CAAWE,KAAX,CAAiBlB,cAAjB,KAAoC,IAN7B,CAAP;AAQC;;AACL,QAAG,KAAKgB,KAAL,CAAWC,IAAX,CAAgBlB,KAAhB,KAAwB,SAA3B,EACA;AACI,aAAO,EAAE,KAAKiB,KAAL,CAAWZ,IAAX,CAAgBJ,cAAhB,KAAmC,IAAnC,IACT,KAAKgB,KAAL,CAAWH,QAAX,CAAoBb,cAApB,KAAuC,IAD9B,IAET,KAAKgB,KAAL,CAAWR,KAAX,CAAiBR,cAAjB,KAAoC,IAF3B,IAGT,KAAKgB,KAAL,CAAWD,QAAX,CAAoBf,cAApB,KAAuC,IAH9B,IAIT,KAAKgB,KAAL,CAAWC,IAAX,CAAgBjB,cAAhB,KAAmC,IAJ1B,IAKT,KAAKgB,KAAL,CAAWI,QAAX,CAAoBpB,cAApB,KAAuC,IAL9B,IAMT,KAAKgB,KAAL,CAAWG,OAAX,CAAmBnB,cAAnB,KAAsC,IAN/B,CAAP;AAQH;;AACD,WAAO,IAAP;AAEH;;AACD4B,EAAAA,cAAc,CAAC7B,KAAD,EAAQ;AAElB,SAAKuC,QAAL,CAAc;AACV,cAAS;AACL,iBAASvC,KADJ;AAEL,0BAAkB,IAFb;AAGL,oBAAY;AAHP;AADC,KAAd;AAQD;;AAGHgD,EAAAA,MAAM,GAAG;AACL,WACI;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAI,MAAA,SAAS,EAAC,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCADJ,EAEI;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,QAAQ,EAAE,KAAKvB,YAArB;AAAmC,MAAA,SAAS,EAAC,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,QAAD;AACI,MAAA,KAAK,EAAC,WADV;AAEI,MAAA,cAAc,EAAE,KAAKR,KAAL,CAAWZ,IAAX,CAAgBJ,cAFpC;AAGI,MAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWZ,IAAX,CAAgBH,QAH1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAII,oBAAC,KAAD;AACI,MAAA,IAAI,EAAC,OADT;AAEI,MAAA,IAAI,EAAC,MAFT;AAGI,MAAA,YAAY,EAAC,KAHjB;AAII,MAAA,WAAW,EAAC,WAJhB;AAKI,MAAA,KAAK,EAAE,KAAKe,KAAL,CAAWZ,IAAX,CAAgBL,KAL3B;AAMI,MAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKlB,iBAAL,CAAuBkB,KAAvB,EAA8B,KAAKrC,YAAnC,CANzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,CADJ,EAaI,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC,UAAhB;AACI,MAAA,WAAW,MADf;AAEI,MAAA,cAAc,EAAE,KAAKa,KAAL,CAAWH,QAAX,CAAoBb,cAFxC;AAGI,MAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWH,QAAX,CAAoBZ,QAH9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAII,oBAAC,KAAD;AACI,MAAA,IAAI,EAAC,OADT;AAEI,MAAA,IAAI,EAAC,UAFT;AAGI,MAAA,YAAY,EAAC,KAHjB;AAII,MAAA,WAAW,EAAC,mBAJhB;AAKI,MAAA,KAAK,EAAE,KAAKe,KAAL,CAAWH,QAAX,CAAoBd,KAL/B;AAMI,MAAA,MAAM,EAAE,KAAK0B,4BANjB;AAOI,MAAA,QAAQ,EAAGe,KAAD,IAAW,KAAKlB,iBAAL,CAAuBkB,KAAvB,EAA8B,KAAK5B,gBAAnC,CAPzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,CAbJ,EA0BI,oBAAC,QAAD;AACI,MAAA,KAAK,EAAC,OADV;AAEI,MAAA,WAAW,MAFf;AAGI,MAAA,cAAc,EAAE,KAAKI,KAAL,CAAWR,KAAX,CAAiBR,cAHrC;AAII,MAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWR,KAAX,CAAiBP,QAJ3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKI,oBAAC,KAAD;AACI,MAAA,IAAI,EAAC,OADT;AAEI,MAAA,IAAI,EAAC,OAFT;AAGI,MAAA,IAAI,EAAC,OAHT;AAII,MAAA,YAAY,EAAC,KAJjB;AAKI,MAAA,WAAW,EAAC,YALhB;AAMI,MAAA,KAAK,EAAE,KAAKe,KAAL,CAAWR,KAAX,CAAiBT,KAN5B;AAOI,MAAA,MAAM,EAAE,KAAK2B,yBAPjB;AAQI,MAAA,QAAQ,EAAGc,KAAD,IAAW,KAAKlB,iBAAL,CAAuBkB,KAAvB,EAA8B,KAAKjC,aAAnC,CARzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALJ,CA1BJ,EAyCI,oBAAC,QAAD;AACI,MAAA,KAAK,EAAC,UADV;AAEI,MAAA,cAAc,EAAE,KAAKS,KAAL,CAAWD,QAAX,CAAoBf,cAFxC;AAGI,MAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWD,QAAX,CAAoBd,QAH9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAII,oBAAC,KAAD;AACI,MAAA,IAAI,EAAC,OADT;AAEI,MAAA,IAAI,EAAC,UAFT;AAGI,MAAA,IAAI,EAAC,UAHT;AAII,MAAA,YAAY,EAAC,KAJjB;AAKI,MAAA,WAAW,EAAC,uCALhB;AAMI,MAAA,KAAK,EAAE,KAAKe,KAAL,CAAWD,QAAX,CAAoBhB,KAN/B;AAOI,MAAA,QAAQ,EAAGyC,KAAD,IAAW,KAAKlB,iBAAL,CAAuBkB,KAAvB,EAA8B,KAAK1B,gBAAnC,CAPzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,CAzCJ,EAsDM,oBAAC,QAAD;AACE,MAAA,KAAK,EAAC,MADR;AAEE,MAAA,cAAc,EAAE,KAAKE,KAAL,CAAWC,IAAX,CAAgBjB,cAFlC;AAGE,MAAA,IAAI,EAAE,KAAKgB,KAAL,CAAWC,IAAX,CAAgBhB,QAHxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIC,oBAAC,MAAD;AACC,MAAA,UAAU,MADX;AAEC,MAAA,KAAK,EAAE;AAAE+C,QAAAA,KAAK,EAAE;AAAT,OAFR;AAGC,MAAA,WAAW,EAAC,eAHb;AAIC,MAAA,gBAAgB,EAAC,UAJlB;AAKC,MAAA,QAAQ,EAAE,KAAKpB,cALhB;AAMC,MAAA,YAAY,EAAE,CAACqB,KAAD,EAAQC,MAAR,KACdA,MAAM,CAACrD,KAAP,CAAasD,QAAb,CAAsBC,WAAtB,GAAoCC,OAApC,CAA4CJ,KAAK,CAACG,WAAN,EAA5C,KAAoE,CAPrE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAUK,KAAKpC,KAAL,CAAWK,KAAX,CAAiBiC,GAAjB,CAAqB,UAASrC,IAAT,EACb;AACI,aACI,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAEA,IAAI,CAACb,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA2Ba,IAAI,CAACb,IAAhC,CADJ;AAGH,KALT,CAVL,CAJD,CAtDN,EA8EK,KAAK0B,2BAAL,CAAiC,KAAKd,KAAL,CAAWC,IAAX,CAAgBlB,KAAjD,CA9EL,EA+EI,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,IAAI,EAAC,SAAb;AACI,MAAA,QAAQ,EAAC,QADb;AAEI,MAAA,IAAI,EAAC,OAFT;AAGI,MAAA,SAAS,EAAC,oBAHd;AAII,MAAA,QAAQ,EAAE,KAAK4B,aAAL,EAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADJ,CA/EJ,CADJ,CAFJ,CADJ;AA+FH,GA1W8B,CA4W/B;;;AA4FAF,EAAAA,4BAA4B,GAAG;AAC3B;AACA,UAAM8B,aAAa,GAAG,KAAKvC,KAAL,CAAWH,QAAX,CAAoBd,KAA1C;AACA,UAAMyD,kBAAkB,GAAG,KAAK5C,gBAAL,CAAsB2C,aAAtB,CAA3B;;AAEA,QAAGC,kBAAkB,CAACxD,cAAnB,KAAsC,KAAzC,EAAgD;AAC5C,WAAKsC,QAAL,CAAc;AACVzB,QAAAA,QAAQ;AACJd,UAAAA,KAAK,EAAEwD;AADH,WAEDC,kBAFC;AADE,OAAd;AAMA;AACH;;AAED,SAAKlB,QAAL,CAAc;AACVzB,MAAAA,QAAQ,EAAE;AACNd,QAAAA,KAAK,EAAEwD,aADD;AAENvD,QAAAA,cAAc,EAAE,YAFV;AAGNC,QAAAA,QAAQ,EAAE;AAHJ;AADA,KAAd;AAQAxB,IAAAA,yBAAyB,CAAC8E,aAAD,CAAzB,CACCrB,IADD,CACMuB,QAAQ,IAAI;AACd,UAAGA,QAAQ,CAACC,SAAZ,EAAuB;AACnB,aAAKpB,QAAL,CAAc;AACVzB,UAAAA,QAAQ,EAAE;AACNd,YAAAA,KAAK,EAAEwD,aADD;AAENvD,YAAAA,cAAc,EAAE,IAFV;AAGNC,YAAAA,QAAQ,EAAE;AAHJ;AADA,SAAd;AAOH,OARD,MAQO;AACH,aAAKqC,QAAL,CAAc;AACVzB,UAAAA,QAAQ,EAAE;AACNd,YAAAA,KAAK,EAAEwD,aADD;AAENvD,YAAAA,cAAc,EAAE,KAFV;AAGNC,YAAAA,QAAQ,EAAE;AAHJ;AADA,SAAd;AAOH;AACJ,KAnBD,EAmBG0D,KAnBH,CAmBSpB,KAAK,IAAI;AACd;AACA,WAAKD,QAAL,CAAc;AACVzB,QAAAA,QAAQ,EAAE;AACNd,UAAAA,KAAK,EAAEwD,aADD;AAENvD,UAAAA,cAAc,EAAE,IAFV;AAGNC,UAAAA,QAAQ,EAAE;AAHJ;AADA,OAAd;AAOH,KA5BD;AA6BH;;AAEDyB,EAAAA,yBAAyB,GAAG;AACxB;AACA,UAAMkC,UAAU,GAAG,KAAK5C,KAAL,CAAWR,KAAX,CAAiBT,KAApC;AACA,UAAM8D,eAAe,GAAG,KAAKtD,aAAL,CAAmBqD,UAAnB,CAAxB;;AAEA,QAAGC,eAAe,CAAC7D,cAAhB,KAAmC,KAAtC,EAA6C;AACzC,WAAKsC,QAAL,CAAc;AACV9B,QAAAA,KAAK;AACDT,UAAAA,KAAK,EAAE6D;AADN,WAEEC,eAFF;AADK,OAAd;AAMA;AACH;;AAED,SAAKvB,QAAL,CAAc;AACV9B,MAAAA,KAAK,EAAE;AACHT,QAAAA,KAAK,EAAE6D,UADJ;AAEH5D,QAAAA,cAAc,EAAE,YAFb;AAGHC,QAAAA,QAAQ,EAAE;AAHP;AADG,KAAd;AAQAvB,IAAAA,sBAAsB,CAACkF,UAAD,CAAtB,CACC1B,IADD,CACMuB,QAAQ,IAAI;AACd,UAAGA,QAAQ,CAACC,SAAZ,EAAuB;AACnB,aAAKpB,QAAL,CAAc;AACV9B,UAAAA,KAAK,EAAE;AACHT,YAAAA,KAAK,EAAE6D,UADJ;AAEH5D,YAAAA,cAAc,EAAE,IAFb;AAGHC,YAAAA,QAAQ,EAAE;AAHP;AADG,SAAd;AAOH,OARD,MAQO;AACH,aAAKqC,QAAL,CAAc;AACV9B,UAAAA,KAAK,EAAE;AACHT,YAAAA,KAAK,EAAE6D,UADJ;AAEH5D,YAAAA,cAAc,EAAE,KAFb;AAGHC,YAAAA,QAAQ,EAAE;AAHP;AADG,SAAd;AAOH;AACJ,KAnBD,EAmBG0D,KAnBH,CAmBSpB,KAAK,IAAI;AACd;AACA,WAAKD,QAAL,CAAc;AACV9B,QAAAA,KAAK,EAAE;AACHT,UAAAA,KAAK,EAAE6D,UADJ;AAEH5D,UAAAA,cAAc,EAAE,IAFb;AAGHC,UAAAA,QAAQ,EAAE;AAHP;AADG,OAAd;AAOH,KA5BD;AA6BH;;AAljB8B;;AAykBnC,eAAeN,UAAf","sourcesContent":["import React, { Component } from 'react';\r\nimport { signup, checkUsernameAvailability, checkEmailAvailability } from '../util/APIUtils';\r\nimport '../assets/css/Signup.css';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport { \r\n    NAME_MIN_LENGTH, NAME_MAX_LENGTH, \r\n    USERNAME_MIN_LENGTH, USERNAME_MAX_LENGTH,\r\n    EMAIL_MAX_LENGTH,\r\n    PASSWORD_MIN_LENGTH, PASSWORD_MAX_LENGTH\r\n} from '../constants';\r\n\r\nimport { Form, Input, Button, notification,Select } from 'antd';\r\nconst FormItem = Form.Item;\r\nconst { Option } = Select;\r\n\r\nclass addAccount extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            name: {\r\n                value: ''\r\n            },\r\n            username: {\r\n                value: ''\r\n            },\r\n            email: {\r\n                value: ''\r\n            },\r\n            password: {\r\n                value: ''\r\n            },\r\n            role:{\r\n                value:'',   \r\n            },\r\n            ville:{\r\n                    value:''\r\n            },\r\n            societe:\r\n                {\r\n                     value:''\r\n                },\r\n            fonction:\r\n                     {\r\n                         value:''\r\n                    },\r\n            roles:[],\r\n\r\n            }\r\n        \r\n        \r\n        this.handleInputChange = this.handleInputChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.validateUsernameAvailability = this.validateUsernameAvailability.bind(this);\r\n        this.validateEmailAvailability = this.validateEmailAvailability.bind(this);\r\n        this.isFormInvalid = this.isFormInvalid.bind(this);\r\n        this.onChangeSelect = this.onChangeSelect.bind(this);\r\n        this.validateFranchise=this.validateFranchise.bind(this);\r\n        this.handleRole=this.handleRole.bind(this);\r\n        this.renderElementSupplementaire=this.renderElementSupplementaire.bind(this);\r\n    }\r\n    componentDidMount() {\r\n        fetch(API_BASE_URL + \"/roles\")\r\n          .then(res => res.json())\r\n          .then(\r\n            (result) => {\r\n              this.setState({\r\n                roles: result\r\n              });\r\n            },\r\n\r\n            (error) => {\r\n              this.setState({\r\n                error\r\n              });\r\n            }\r\n          )\r\n      }\r\n renderElementSupplementaire(role)\r\n    {\r\n        if(role==='Franch')\r\n        {\r\n            return(\r\n            <div>\r\n                <FormItem label=\"Ville\"\r\n                            validateStatus={this.state.ville.validateStatus}\r\n                            help={this.state.ville.errorMsg}>\r\n                             \r\n                            <Input \r\n                                    size=\"large\"\r\n                                    name=\"ville\" \r\n                                    autoComplete=\"off\"\r\n                                    placeholder=\"ex: Casablanca\"\r\n                                    value= {this.state.ville.value} \r\n                                    onChange={(event) => this.handleRole(event, this.validateFranchise)} />    \r\n               </FormItem>\r\n                <FormItem \r\n                label=\"Fonction\"\r\n                validateStatus={this.state.fonction.validateStatus}\r\n                help={this.state.fonction.errorMsg}>\r\n                   \r\n                <Input \r\n                    size=\"large\"\r\n                    name=\"fonctionFr\" \r\n                    autoComplete=\"off\"\r\n                    placeholder=\"ex: responsable marketing\"\r\n                    value={this.state.fonction.value} \r\n                    onChange={(event) => this.handleRole(event, this.validateFranchise)} />    \r\n                </FormItem>\r\n            </div>\r\n            )\r\n\r\n        }\r\n        if(role ==='GCompte')\r\n        {\r\n            return(\r\n                <div>\r\n                <FormItem label=\"Societe\"\r\n                            validateStatus={this.state.societe.validateStatus}\r\n                            help={this.state.societe.errorMsg}>\r\n                             \r\n                                <Input \r\n                                    size=\"large\"\r\n                                    name=\"societe\" \r\n                                    autoComplete=\"off\"\r\n                                    placeholder=\"ex: IAM\"\r\n                                    value={this.state.societe.value} \r\n                                    onChange={(event) => this.handleRole(event, this.validateFranchise)} />    \r\n               </FormItem>\r\n                <FormItem label=\"Fonction\"\r\n                            validateStatus={this.state.fonction.validateStatus}\r\n                            help={this.state.fonction.errorMsg}>\r\n                \r\n                <Input \r\n                    size=\"large\"\r\n                    name=\"fonctionGc\" \r\n                    autoComplete=\"off\"\r\n                    placeholder=\"ex: responsable marketing\"\r\n                    value={this.state.fonction.value} \r\n                    onChange={(event) => this.handleRole(event, this.validateFranchise)} />    \r\n                </FormItem>\r\n                </div>\r\n            );\r\n            }\r\n\r\n        \r\n    }\r\n    handleRole(event,validationFun){\r\n        const target = event.target;\r\n        const inputName = target.name;        \r\n        const inputValue = target.value;\r\n        if(inputName===\"fonctionGc\")\r\n        {\r\n            this.setState({\r\n                    'fonction':{\r\n                        'value': inputValue,\r\n                        ...validationFun(inputValue),\r\n                }\r\n            \r\n            });\r\n        }\r\n        if(inputName===\"fonctionFr\")\r\n        {\r\n            this.setState({\r\n               \r\n                    'fonction':{\r\n                        'value':inputValue,\r\n                            ...validationFun(inputValue),\r\n                    }\r\n            });\r\n        }\r\n        if(inputName===\"ville\")\r\n        {\r\n            this.setState({\r\n                \r\n                    'ville':{\r\n                        'value':inputValue,\r\n                        ...validationFun(inputValue)\r\n                \r\n            }\r\n            });\r\n        }\r\n        if(inputName===\"societe\")\r\n        {\r\n            this.setState({\r\n              \r\n                \r\n                    'societe':{\r\n                        'value': inputValue,\r\n                        ...validationFun(inputValue)\r\n\r\n            }\r\n            });\r\n        }\r\n    }\r\n    handleInputChange(event, validationFun) {\r\n        const target = event.target;\r\n        const inputName = target.name;        \r\n        const inputValue = target.value;\r\n    \r\n        this.setState({\r\n            [inputName] : {\r\n                value: inputValue,\r\n                ...validationFun(inputValue)\r\n            }\r\n    })\r\n}\r\n\r\n    handleSubmit(event) {\r\n        event.preventDefault();\r\n    \r\n        const createAccountRequest = {\r\n            name: this.state.name.value,\r\n            email: this.state.email.value,\r\n            username: this.state.username.value,\r\n            password: this.state.password.value,\r\n            role : this.state.role.value,\r\n        };\r\n        /*signup(signupRequest)\r\n        .then(response => {\r\n            notification.success({\r\n                message: 'Polling App',\r\n                description: \"Thank you! Account has been created successfully !\",\r\n            });          \r\n            this.props.history.push(\"/login\");\r\n        }).catch(error => {\r\n            notification.error({\r\n                message: 'Polling App',\r\n                description: error.message || 'Sorry! Something went wrong. Please try again!'\r\n            });\r\n        });*/\r\n    }\r\n\r\n    isFormInvalid() {\r\n        \r\n        if(this.state.role.value==='PSD')\r\n        {\r\n        return !(this.state.name.validateStatus === true &&\r\n            this.state.username.validateStatus === true &&\r\n            this.state.email.validateStatus === true &&\r\n            this.state.password.validateStatus === true &&\r\n            this.state.role.validateStatus === true \r\n        );\r\n        }\r\n        if(this.state.role.value==='Franch')\r\n        {\r\n            return !(this.state.name.validateStatus === true &&\r\n            this.state.username.validateStatus === true &&\r\n            this.state.email.validateStatus === true &&\r\n            this.state.password.validateStatus === true &&\r\n            this.state.role.validateStatus === true &&\r\n            this.state.fonction.validateStatus === true &&\r\n            this.state.ville.validateStatus === true\r\n        );\r\n            }\r\n        if(this.state.role.value==='GCompte')\r\n        {\r\n            return !(this.state.name.validateStatus === true &&\r\n            this.state.username.validateStatus === true &&\r\n            this.state.email.validateStatus === true &&\r\n            this.state.password.validateStatus === true &&\r\n            this.state.role.validateStatus === true &&\r\n            this.state.fonction.validateStatus === true &&\r\n            this.state.societe.validateStatus === true\r\n        );\r\n        }\r\n        return true;\r\n        \r\n    }\r\n    onChangeSelect(value) {\r\n\r\n        this.setState({\r\n            'role' : {\r\n                'value': value,\r\n                'validateStatus': true,\r\n                'errorMsg': null,\r\n                \r\n            }\r\n        });\r\n      }\r\n      \r\n    \r\n    render() {\r\n        return (\r\n            <div className=\"signup-container\">\r\n                <h1 className=\"page-title\">Creation d'un compte :</h1>\r\n                <div className=\"signup-content\">\r\n                    <Form onSubmit={this.handleSubmit} className=\"signup-form\">\r\n                        <FormItem \r\n                            label=\"Full Name\"\r\n                            validateStatus={this.state.name.validateStatus}\r\n                            help={this.state.name.errorMsg}>\r\n                            <Input \r\n                                size=\"large\"\r\n                                name=\"name\"\r\n                                autoComplete=\"off\"\r\n                                placeholder=\"Full name\"\r\n                                value={this.state.name.value} \r\n                                onChange={(event) => this.handleInputChange(event, this.validateName)} />    \r\n                        </FormItem>\r\n                        <FormItem label=\"Username\"\r\n                            hasFeedback\r\n                            validateStatus={this.state.username.validateStatus}\r\n                            help={this.state.username.errorMsg}>\r\n                            <Input \r\n                                size=\"large\"\r\n                                name=\"username\" \r\n                                autoComplete=\"off\"\r\n                                placeholder=\"A unique username\"\r\n                                value={this.state.username.value} \r\n                                onBlur={this.validateUsernameAvailability}\r\n                                onChange={(event) => this.handleInputChange(event, this.validateUsername)} />    \r\n                        </FormItem>\r\n                        <FormItem \r\n                            label=\"Email\"\r\n                            hasFeedback\r\n                            validateStatus={this.state.email.validateStatus}\r\n                            help={this.state.email.errorMsg}>\r\n                            <Input \r\n                                size=\"large\"\r\n                                name=\"email\" \r\n                                type=\"email\" \r\n                                autoComplete=\"off\"\r\n                                placeholder=\"Your email\"\r\n                                value={this.state.email.value} \r\n                                onBlur={this.validateEmailAvailability}\r\n                                onChange={(event) => this.handleInputChange(event, this.validateEmail)} />    \r\n                        </FormItem>\r\n                        <FormItem \r\n                            label=\"Password\"\r\n                            validateStatus={this.state.password.validateStatus}\r\n                            help={this.state.password.errorMsg}>\r\n                            <Input \r\n                                size=\"large\"\r\n                                name=\"password\" \r\n                                type=\"password\"\r\n                                autoComplete=\"off\"\r\n                                placeholder=\"A password between 6 to 20 characters\" \r\n                                value={this.state.password.value} \r\n                                onChange={(event) => this.handleInputChange(event, this.validatePassword)} />  \r\n                        </FormItem>\r\n                          <FormItem \r\n                            label=\"Role\"\r\n                            validateStatus={this.state.role.validateStatus}\r\n                            help={this.state.role.errorMsg}>\r\n                           <Select\r\n                            showSearch\r\n                            style={{ width: 200 }}\r\n                            placeholder=\"Select a role\"\r\n                            optionFilterProp=\"children\"\r\n                            onChange={this.onChangeSelect}\r\n                            filterOption={(input, option) =>\r\n                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                }\r\n                            >\r\n                            {   this.state.roles.map(function(role)\r\n                                        {\r\n                                            return (\r\n                                                <Option value={role.name}>{role.name}</Option>\r\n                                            )\r\n                                        })\r\n                            }\r\n                            \r\n                        </Select>\r\n                        </FormItem>\r\n                        {this.renderElementSupplementaire(this.state.role.value)}\r\n                        <FormItem>\r\n                            <Button type=\"primary\" \r\n                                htmlType=\"submit\" \r\n                                size=\"large\" \r\n                                className=\"signup-form-button\"\r\n                                disabled={this.isFormInvalid()}>Creation de compte</Button>\r\n                          \r\n                        </FormItem>\r\n                    </Form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Validation Functions\r\n    validateFranchise=(value)=>{\r\n        if(!value) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: 'Content may not be empty'                \r\n            \r\n            }\r\n        }\r\n        if(value.trim()==\"\")\r\n        {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: 'Content may not be empty' \r\n            }  \r\n\r\n        }\r\n       \r\n        return {\r\n                validateStatus: true,\r\n                errorMsg: null  ,           \r\n            }\r\n    }\r\n \r\n    \r\n    validateName = (name) => {\r\n        if(name.length < NAME_MIN_LENGTH) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: `Name is too short (Minimum ${NAME_MIN_LENGTH} characters needed.)`\r\n            }\r\n        } else if (name.length > NAME_MAX_LENGTH) {\r\n            return {\r\n                validationStatus: false ,\r\n                errorMsg: `Name is too long (Maximum ${NAME_MAX_LENGTH} characters allowed.)`\r\n            }\r\n        } else {\r\n            return {\r\n                validateStatus: true,\r\n                errorMsg: null,\r\n              };            \r\n        }\r\n    }\r\n\r\n    validateEmail = (email) => {\r\n        if(!email) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: 'Email may not be empty'                \r\n            }\r\n        }\r\n\r\n        const EMAIL_REGEX = RegExp('[^@ ]+@[^@ ]+\\\\.[^@ ]+');\r\n        if(!EMAIL_REGEX.test(email)) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: 'Email not valid'\r\n            }\r\n        }\r\n\r\n        if(email.length > EMAIL_MAX_LENGTH) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: `Email is too long (Maximum ${EMAIL_MAX_LENGTH} characters allowed)`\r\n            }\r\n        }\r\n\r\n        return {\r\n            validateStatus: null,\r\n            errorMsg: null\r\n        }\r\n    }\r\n\r\n    validateUsername = (username) => {\r\n        if(username.length < USERNAME_MIN_LENGTH) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: `Username is too short (Minimum ${USERNAME_MIN_LENGTH} characters needed.)`\r\n            }\r\n        } else if (username.length > USERNAME_MAX_LENGTH) {\r\n            return {\r\n                validationStatus: false,\r\n                errorMsg: `Username is too long (Maximum ${USERNAME_MAX_LENGTH} characters allowed.)`\r\n            }\r\n        } else {\r\n            return {\r\n                validateStatus: null,\r\n                errorMsg: null\r\n            }\r\n        }\r\n    }\r\n\r\n    validateUsernameAvailability() {\r\n        // First check for client side errors in username\r\n        const usernameValue = this.state.username.value;\r\n        const usernameValidation = this.validateUsername(usernameValue);\r\n\r\n        if(usernameValidation.validateStatus === false) {\r\n            this.setState({\r\n                username: {\r\n                    value: usernameValue,\r\n                    ...usernameValidation\r\n                }\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            username: {\r\n                value: usernameValue,\r\n                validateStatus: 'validating',\r\n                errorMsg: null\r\n            }\r\n        });\r\n\r\n        checkUsernameAvailability(usernameValue)\r\n        .then(response => {\r\n            if(response.available) {\r\n                this.setState({\r\n                    username: {\r\n                        value: usernameValue,\r\n                        validateStatus: true,\r\n                        errorMsg: null\r\n                    }\r\n                });\r\n            } else {\r\n                this.setState({\r\n                    username: {\r\n                        value: usernameValue,\r\n                        validateStatus: false,\r\n                        errorMsg: 'This username is already taken'\r\n                    }\r\n                });\r\n            }\r\n        }).catch(error => {\r\n            // Marking validateStatus as success, Form will be recchecked at server\r\n            this.setState({\r\n                username: {\r\n                    value: usernameValue,\r\n                    validateStatus: true,\r\n                    errorMsg: null\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    validateEmailAvailability() {\r\n        // First check for client side errors in email\r\n        const emailValue = this.state.email.value;\r\n        const emailValidation = this.validateEmail(emailValue);\r\n\r\n        if(emailValidation.validateStatus === false) {\r\n            this.setState({\r\n                email: {\r\n                    value: emailValue,\r\n                    ...emailValidation\r\n                }\r\n            });    \r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            email: {\r\n                value: emailValue,\r\n                validateStatus: 'validating',\r\n                errorMsg: null\r\n            }\r\n        });\r\n\r\n        checkEmailAvailability(emailValue)\r\n        .then(response => {\r\n            if(response.available) {\r\n                this.setState({\r\n                    email: {\r\n                        value: emailValue,\r\n                        validateStatus: true,\r\n                        errorMsg: null\r\n                    }\r\n                });\r\n            } else {\r\n                this.setState({\r\n                    email: {\r\n                        value: emailValue,\r\n                        validateStatus: false,\r\n                        errorMsg: 'This Email is already registered'\r\n                    }\r\n                });\r\n            }\r\n        }).catch(error => {\r\n            // Marking validateStatus as success, Form will be recchecked at server\r\n            this.setState({\r\n                email: {\r\n                    value: emailValue,\r\n                    validateStatus: true,\r\n                    errorMsg: null\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    validatePassword = (password) => {\r\n        if(password.length < PASSWORD_MIN_LENGTH) {\r\n            return {\r\n                validateStatus: false,\r\n                errorMsg: `Password is too short (Minimum ${PASSWORD_MIN_LENGTH} characters needed.)`\r\n            }\r\n        } else if (password.length > PASSWORD_MAX_LENGTH) {\r\n            return {\r\n                validationStatus: false,\r\n                errorMsg: `Password is too long (Maximum ${PASSWORD_MAX_LENGTH} characters allowed.)`\r\n            }\r\n        } else {\r\n            return {\r\n                validateStatus: true,\r\n                errorMsg: null,\r\n            };            \r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default addAccount;"]},"metadata":{},"sourceType":"module"}